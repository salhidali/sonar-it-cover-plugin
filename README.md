# sonar-it-cover-plugin

Since Sonar 6.2, IT coverage metric have been discarded in project dashboard. Only Overall coverage is shown which is the result of merging both both of Jacoco results (jacoco.exec and jacoco-it.exec).

The purpose of this plugin is to:
- Compute the coverage value based on the jacoco-it.exec file.
- update a custom metric value related to the coverage (this custom metric should be created in Sonar). If this metric does not exist in the Sonar project, it will be created with the value computed.


mvn org.otcover:sonar-it-cover-plugin:1.0-SNAPSHOT:itcover -Ditcover.project="test" -Ditcover.metricKey="it_coverage" -DprojectDirectory="C:/Users/dali/Desktop/workspace/java-jacoco" -Ditcover.executionDataFile="C:/Users/dali/Desktop/workspace/sonar-custom-plugin/src/main/java/jacoco.exec" -Ditcover.classesDirectory="C:/Users/dali/Desktop/workspace/usecasetracker-back/target/UseCaseTracker/WEB-INF/classes" -Ditcover.sourceDirectory="C:/Users/dali/Desktop/workspace/usecasetracker-back/src" -Ditcover.reportDirectory="C:/Users/dali/Desktop/workspace/java-jacoco/coveragereport/cover.xml"

/**
	 * @parameter default-value="${project.groupId}:${project.artifactId}" expression="${itcover.project}"
	 */
	//@Parameter( property = "itcover.project", defaultValue = "admin" )
	private String project;

	/**
	 * Sonar custom measure that would be modified
	 * @parameter default-value="it_coverage" expression="${itcover.metricKey}"
	 */
	private String metricKey;
	
	/**
	 * Sonar URL (No default value defined)
	 * @parameter expression="${itcover.sonarUrl}"
	 */
	private String sonarUrl;
	
	/**
	 * Sonar username
	 * @parameter default-value="admin" expression="${itcover.sonarUsername}"
	 */
	private String sonarUsername;
	
	/**
	 * Sonar password
	 * @parameter default-value="admin" expression="${itcover.sonarPassword}"
	 */
	private String sonarPassword;

	/**
	 * The project basedir
	 *@parameter default-value="${basedir}"
	 */
	private File basedir;
	
	/**
	 * Execution Data File (generated by jacoco)
	 * @parameter default-value="${project.build.directory}/jacoco-it.exec" expression="${itcover.executionDataFile}"
	 */
	private File executionDataFile;
	
	/**
     * The directory containing generated classes of the project being tested. This will be included after the test
     * classes in the test classpath.
     *
     * @parameter default-value="${project.build.outputDirectory}"
     */
	private File classesDirectory;
	
	/**
     * The source directory containing class sources.
     *
     * @parameter default-value="${project.build.sourceDirectory}"
     */
	private File sourceDirectory;
	
	/**
	 * @parameter default-value="${project.build.directory}/it-cover.xml" expression="${itcover.reportFile}"
	 */
	private File reportFile;
